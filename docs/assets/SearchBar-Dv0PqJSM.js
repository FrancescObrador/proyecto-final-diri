import{l as W,r as l,a as te,j as T,b as ne}from"./index-o-kKt6OZ.js";var D=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function re(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}const ae="https://api.themoviedb.org/3";class ie{async fetchFromAPI(e){W.info("fetch api TMDB");let n={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJhOTA0YmY4OGEwODc0ODg3MDNhNTdmNGJmZmYwMTliNyIsIm5iZiI6MTczOTAzMzE3MS4xOTM5OTk4LCJzdWIiOiI2N2E3OGE1MzVmYTQyZDdlNzZmMTFiODYiLCJzY29wZXMiOlsiYXBpX3JlYWQiXSwidmVyc2lvbiI6MX0.mzClWScnVaDlNgieVlrE-0-0bX48AukSJYBPnY5OUHc"}};const o=await fetch(`${ae}${e}`,n);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}async getPopularMedia(e=1){return await new Promise(n=>setTimeout(n,2e3)),await this.fetchFromAPI(`/movie/popular?language=es-ES&page=${e}`)}async getMovieDetails(e){let n=await this.fetchFromAPI(`/movie/${e}?language=es-ES`);return n={...n,media_type:"movie"},n}async getTVDetails(e){let n=await this.fetchFromAPI(`/tv/${e}?language=es-ES`);return n={...n,media_type:"tv"},n}async getMediaPlatforms(e){return await this.fetchFromAPI(`/movie/${e}/watch/providers`)}async searchMedia(e,n=1){return await this.fetchFromAPI(`/search/multi?query=${encodeURIComponent(e)}&language=es-ES&page=${n}`)}async getTopRatedMeia(e=1){return await this.fetchFromAPI(`/movie/top_rated&page=${e}`)}async getUpcomingMedia(e=1){return await this.fetchFromAPI(`/movie/upcoming&page=${e}`)}async getNowPlayingMedia(e=1){return await this.fetchFromAPI(`/movie/now_playing&page=${e}`)}}const R=new ie;var L,V;function oe(){if(V)return L;V=1;var a="Expected a function",e=NaN,n="[object Symbol]",o=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,d=/^0o[0-7]+$/i,p=parseInt,y=typeof D=="object"&&D&&D.Object===Object&&D,I=typeof self=="object"&&self&&self.Object===Object&&self,r=y||I||Function("return this")(),m=Object.prototype,_=m.toString,G=Math.max,U=Math.min,$=function(){return r.Date.now()};function X(t,s,h){var v,S,O,w,f,b,E=0,B=!1,M=!1,F=!0;if(typeof t!="function")throw new TypeError(a);s=k(s)||0,P(h)&&(B=!!h.leading,M="maxWait"in h,O=M?G(k(h.maxWait)||0,s):O,F="trailing"in h?!!h.trailing:F);function N(i){var g=v,j=S;return v=S=void 0,E=i,w=t.apply(j,g),w}function Z(i){return E=i,f=setTimeout(x,s),B?N(i):w}function H(i){var g=i-b,j=i-E,J=s-g;return M?U(J,O-j):J}function C(i){var g=i-b,j=i-E;return b===void 0||g>=s||g<0||M&&j>=O}function x(){var i=$();if(C(i))return z(i);f=setTimeout(x,H(i))}function z(i){return f=void 0,F&&v?N(i):(v=S=void 0,w)}function K(){f!==void 0&&clearTimeout(f),E=0,v=b=S=f=void 0}function ee(){return f===void 0?w:z($())}function A(){var i=$(),g=C(i);if(v=arguments,S=this,b=i,g){if(f===void 0)return Z(b);if(M)return f=setTimeout(x,s),N(b)}return f===void 0&&(f=setTimeout(x,s)),w}return A.cancel=K,A.flush=ee,A}function P(t){var s=typeof t;return!!t&&(s=="object"||s=="function")}function Q(t){return!!t&&typeof t=="object"}function q(t){return typeof t=="symbol"||Q(t)&&_.call(t)==n}function k(t){if(typeof t=="number")return t;if(q(t))return e;if(P(t)){var s=typeof t.valueOf=="function"?t.valueOf():t;t=P(s)?s+"":s}if(typeof t!="string")return t===0?t:+t;t=t.replace(o,"");var h=c.test(t);return h||d.test(t)?p(t.slice(2),h?2:8):u.test(t)?e:+t}return L=X,L}var se=oe();const Y=re(se);function ce(a){const e=l.useRef(a);e.current=a,l.useEffect(()=>()=>{e.current()},[])}function ue(a,e=500,n){const o=l.useRef();ce(()=>{o.current&&o.current.cancel()});const u=l.useMemo(()=>{const c=Y(a,e,n),d=(...p)=>c(...p);return d.cancel=()=>{c.cancel()},d.isPending=()=>!!o.current,d.flush=()=>c.flush(),d},[a,e,n]);return l.useEffect(()=>{o.current=Y(a,e,n)},[a,e,n]),u}function fe(a,e,n){const o=(I,r)=>I===r,u=a instanceof Function?a():a,[c,d]=l.useState(u),p=l.useRef(u),y=ue(d,e,n);return o(p.current,u)||(y(u),p.current=u),[c,y]}const le=()=>{const[a,e]=l.useState(""),[n,o]=l.useState([]),u=te(),[c,d]=fe("",300);l.useEffect(()=>{(async()=>{if(c)try{const m=await R.searchMedia(c);o(m.results)}catch{W.error("Error searching:"+c),o([])}else o([])})()},[c]);const p=async r=>{const m=r.target.value;e(m),d(m)},y=async(r,m)=>{let _=m==="tv"?await R.getTVDetails(r):await R.getMovieDetails(r);u(ne(_)),o([]),e("")},I=()=>{o([]),e("")};return T.jsxs("div",{className:"form-control relative",children:[T.jsx("input",{type:"text",value:a,onChange:p,onBlur:I,placeholder:"Search",className:"input input-bordered w-auto md:w-128"}),n.length>0&&T.jsx("ul",{className:"absolute top-full mt-1 w-full bg-base-100 border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:n.map(r=>((r.title||r.name)&&r.release_date||r.first_air_date)&&T.jsxs("li",{onMouseDown:()=>y(r.id,r.media_type),className:"flex flex-row items-center p-2 space-x-2 hover:bg-base-200 cursor-pointer",children:[T.jsx("img",{src:`https://image.tmdb.org/t/p/w200${r.poster_path}`,className:"w-10 h-15"}),T.jsx("p",{children:r.media_type==="tv"?`${r.name} - ${new Date(r.first_air_date).toLocaleDateString("es-ES",{year:"numeric"})}`:`${r.title} - ${new Date(r.release_date).toLocaleDateString("es-ES",{year:"numeric"})}`})]},r.id))})]})};export{le as default};
