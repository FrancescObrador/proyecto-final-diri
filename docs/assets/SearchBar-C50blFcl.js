var ne=Object.defineProperty;var re=(r,e,t)=>e in r?ne(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var A=(r,e,t)=>re(r,typeof e!="symbol"?e+"":e,t);import{r as f,b as ie,j as I,c as ae}from"./index-CMR3FlN9.js";var D=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function oe(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}class se{constructor(){A(this,"levels");A(this,"currentLevel");this.levels=["debug","info","warn","error"],this.currentLevel="debug"}setLevel(e){this.levels.includes(e)?this.currentLevel=e:console.error(`Nivel de log no vÃ¡lido: ${e}`)}log(e,t){const a=this.levels.indexOf(e),u=this.levels.indexOf(this.currentLevel);if(a>=u){const c=new Date().toISOString();console[e](`[${e.toUpperCase()}] ${c}: ${t}`)}}debug(e){this.log("debug",e)}info(e){this.log("info",e)}warn(e){this.log("warn",e)}error(e){this.log("error",e)}}const W=new se,ce="https://api.themoviedb.org/3";class ue{async fetchFromAPI(e){W.info("fetch api TMDB");let t={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJhOTA0YmY4OGEwODc0ODg3MDNhNTdmNGJmZmYwMTliNyIsIm5iZiI6MTczOTAzMzE3MS4xOTM5OTk4LCJzdWIiOiI2N2E3OGE1MzVmYTQyZDdlNzZmMTFiODYiLCJzY29wZXMiOlsiYXBpX3JlYWQiXSwidmVyc2lvbiI6MX0.mzClWScnVaDlNgieVlrE-0-0bX48AukSJYBPnY5OUHc"}};const a=await fetch(`${ce}${e}`,t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}async getPopularMedia(e=1){return await new Promise(t=>setTimeout(t,2e3)),await this.fetchFromAPI(`/movie/popular?language=es-ES&page=${e}`)}async getMovieDetails(e){let t=await this.fetchFromAPI(`/movie/${e}?language=es-ES`);return t={...t,media_type:"movie"},t}async getTVDetails(e){let t=await this.fetchFromAPI(`/tv/${e}?language=es-ES`);return t={...t,media_type:"tv"},t}async getMediaPlatforms(e){return await this.fetchFromAPI(`/movie/${e}/watch/providers`)}async searchMedia(e,t=1){return await this.fetchFromAPI(`/search/multi?query=${encodeURIComponent(e)}&language=es-ES&page=${t}`)}async getTopRatedMeia(e=1){return await this.fetchFromAPI(`/movie/top_rated&page=${e}`)}async getUpcomingMedia(e=1){return await this.fetchFromAPI(`/movie/upcoming&page=${e}`)}async getNowPlayingMedia(e=1){return await this.fetchFromAPI(`/movie/now_playing&page=${e}`)}}const R=new ue;var C,Y;function le(){if(Y)return C;Y=1;var r="Expected a function",e=NaN,t="[object Symbol]",a=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,d=/^0o[0-7]+$/i,g=parseInt,y=typeof D=="object"&&D&&D.Object===Object&&D,T=typeof self=="object"&&self&&self.Object===Object&&self,i=y||T||Function("return this")(),m=Object.prototype,$=m.toString,G=Math.max,X=Math.min,_=function(){return i.Date.now()};function Q(n,s,h){var v,S,x,w,l,b,O=0,B=!1,E=!1,N=!0;if(typeof n!="function")throw new TypeError(r);s=k(s)||0,L(h)&&(B=!!h.leading,E="maxWait"in h,x=E?G(k(h.maxWait)||0,s):x,N="trailing"in h?!!h.trailing:N);function P(o){var p=v,M=S;return v=S=void 0,O=o,w=n.apply(M,p),w}function H(o){return O=o,l=setTimeout(j,s),B?P(o):w}function K(o){var p=o-b,M=o-O,V=s-p;return E?X(V,x-M):V}function z(o){var p=o-b,M=o-O;return b===void 0||p>=s||p<0||E&&M>=x}function j(){var o=_();if(z(o))return J(o);l=setTimeout(j,K(o))}function J(o){return l=void 0,N&&v?P(o):(v=S=void 0,w)}function ee(){l!==void 0&&clearTimeout(l),O=0,v=b=S=l=void 0}function te(){return l===void 0?w:J(_())}function F(){var o=_(),p=z(o);if(v=arguments,S=this,b=o,p){if(l===void 0)return H(b);if(E)return l=setTimeout(j,s),P(b)}return l===void 0&&(l=setTimeout(j,s)),w}return F.cancel=ee,F.flush=te,F}function L(n){var s=typeof n;return!!n&&(s=="object"||s=="function")}function q(n){return!!n&&typeof n=="object"}function Z(n){return typeof n=="symbol"||q(n)&&$.call(n)==t}function k(n){if(typeof n=="number")return n;if(Z(n))return e;if(L(n)){var s=typeof n.valueOf=="function"?n.valueOf():n;n=L(s)?s+"":s}if(typeof n!="string")return n===0?n:+n;n=n.replace(a,"");var h=c.test(n);return h||d.test(n)?g(n.slice(2),h?2:8):u.test(n)?e:+n}return C=Q,C}var de=le();const U=oe(de);function fe(r){const e=f.useRef(r);e.current=r,f.useEffect(()=>()=>{e.current()},[])}function me(r,e=500,t){const a=f.useRef();fe(()=>{a.current&&a.current.cancel()});const u=f.useMemo(()=>{const c=U(r,e,t),d=(...g)=>c(...g);return d.cancel=()=>{c.cancel()},d.isPending=()=>!!a.current,d.flush=()=>c.flush(),d},[r,e,t]);return f.useEffect(()=>{a.current=U(r,e,t)},[r,e,t]),u}function he(r,e,t){const a=(T,i)=>T===i,u=r instanceof Function?r():r,[c,d]=f.useState(u),g=f.useRef(u),y=me(d,e,t);return a(g.current,u)||(y(u),g.current=u),[c,y]}const be=()=>{const[r,e]=f.useState(""),[t,a]=f.useState([]),u=ie(),[c,d]=he("",300);f.useEffect(()=>{(async()=>{if(c)try{const m=await R.searchMedia(c);a(m.results)}catch{W.error("Error searching:"+c),a([])}else a([])})()},[c]);const g=async i=>{const m=i.target.value;e(m),d(m)},y=async(i,m)=>{let $=m==="tv"?await R.getTVDetails(i):await R.getMovieDetails(i);u(ae($)),a([]),e("")},T=()=>{a([]),e("")};return I.jsxs("div",{className:"form-control relative",children:[I.jsx("input",{type:"text",value:r,onChange:g,onBlur:T,placeholder:"Search",className:"input input-bordered w-auto md:w-128"}),t.length>0&&I.jsx("ul",{className:"absolute top-full mt-1 w-full bg-base-100 border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:t.map(i=>((i.title||i.name)&&i.release_date||i.first_air_date)&&I.jsxs("li",{onMouseDown:()=>y(i.id,i.media_type),className:"flex flex-row items-center p-2 space-x-2 hover:bg-base-200 cursor-pointer",children:[I.jsx("img",{src:`https://image.tmdb.org/t/p/w200${i.poster_path}`,className:"w-10 h-15"}),I.jsx("p",{children:i.media_type==="tv"?`${i.name} - ${new Date(i.first_air_date).toLocaleDateString("es-ES",{year:"numeric"})}`:`${i.title} - ${new Date(i.release_date).toLocaleDateString("es-ES",{year:"numeric"})}`})]},i.id))})]})};export{be as default};
